{% extends 'UserPage/Admin/index.html.twig' %}

{% block title %}Activity Logs
{% endblock %}

{% block admin_content %}
	<div
		class="space-y-6">

		<!-- Header + Filters -->
		<div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
			<div>
				<h2 class="text-xl font-semibold text-gray-800">Activity Logs</h2>
				<p class="text-sm text-gray-500 mt-1">
					Full audit trail of system actions
				</p>
			</div>

			<form method="get" class="flex flex-wrap gap-2 items-end">
				<div class="flex flex-col">
					<label class="text-sm font-medium text-gray-700">User</label>
					<input type="text" name="username" value="{{ app.request.get('username') }}" class="border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring focus:ring-blue-200"/>
				</div>

				<div class="flex flex-col">
					<label class="text-sm font-medium text-gray-700">Action</label>
					<select name="action" class="border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring focus:ring-blue-200">
						<option value="">All</option>
						<option value="create" {% if app.request.get('action') == 'create' %} selected {% endif %}>Create</option>
						<option value="update" {% if app.request.get('action') == 'update' %} selected {% endif %}>Update</option>
						<option value="delete" {% if app.request.get('action') == 'delete' %} selected {% endif %}>Delete</option>
						<option value="login" {% if app.request.get('action') == 'login' %} selected {% endif %}>Login</option>
						<option value="logout" {% if app.request.get('action') == 'logout' %} selected {% endif %}>Logout</option>
					</select>
				</div>

				<div class="flex flex-col">
					<label class="text-sm font-medium text-gray-700">From</label>
					<input type="date" name="date_from" value="{{ app.request.get('date_from') }}" class="border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring focus:ring-blue-200"/>
				</div>

				<div class="flex flex-col">
					<label class="text-sm font-medium text-gray-700">To</label>
					<input type="date" name="date_to" value="{{ app.request.get('date_to') }}" class="border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring focus:ring-blue-200"/>
				</div>

				<button type="submit" class="bg-primary text-white text-sm font-medium px-4 py-2 rounded-xl shadow hover:scale-105 transform transition-all">
					Filter
				</button>
			</form>
		</div>

		<!-- Logs Table -->
		<div class="bg-white rounded-2xl shadow overflow-x-auto max-h-[500px] overflow-y-auto">
			<table class="min-w-full divide-y divide-gray-200">
				<thead class="bg-gray-50">
					<tr>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Target Data</th>
					</tr>
				</thead>
				<tbody class="bg-white divide-y divide-gray-100">
					{% for log in logs %}
						<tr class="hover:bg-gray-50 transition-colors">
							<td class="px-6 py-4 font-mono text-sm text-gray-600">{{ log.createdAt|date('Y-m-d H:i') }}</td>
							<td class="px-6 py-4 text-gray-700">{{ log.username }}</td>
							<td class="px-6 py-4 text-gray-700">{{ log.role }}</td>
							<td class="px-6 py-4 text-gray-800 font-semibold">{{ log.action }}</td>
							<td class="px-6 py-4 text-gray-700">{{ log.targetData }}</td>
						</tr>
					{% else %}
						<tr>
							<td colspan="5" class="px-6 py-4 text-center text-gray-400 text-sm">
								No logs found.
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>

	</div>
{% endblock %}
