<!-- Alpine.js container -->
<div
	x-data="{
								        sidebarOpen: JSON.parse(localStorage.getItem('sidebarOpen')) ?? true,
								        toggleSidebar() {
								            this.sidebarOpen = !this.sidebarOpen;
								            localStorage.setItem('sidebarOpen', JSON.stringify(this.sidebarOpen));
								        }
								    }" class="flex h-screen bg-gray-100">
	<!-- Desktop sidebar -->
	<aside :class="sidebarOpen ? 'w-60' : 'w-20'" class="hidden md:flex md:flex-col h-screen bg-[rgb(34,36,38)] text-white transition-all duration-300 shadow-lg">
		<div class="flex items-center justify-between p-4">
			<img x-show="sidebarOpen" src="{{ asset('images/logo-light.png') }}" alt="Logo" class="h-20 w-auto transition-all"/>
			<button @click="toggleSidebar()" class="p-4 rounded hover:bg-gray-700 transition">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewbox="0 0 24 24" stroke="currentColor">
					<path x-show="sidebarOpen" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 6L6 12l12 6V6z"/>
					<path x-show="!sidebarOpen" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 12 6 6v12z"/>
				</svg>
			</button>
		</div>

		{% set allMenu = [
    {'label': 'Dashboard', 'icon': 'M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z', 'route': 'app_admin_dashboard'},
    {'label': 'Users', 'icon': 'M17 20h5v-1a4 4 0 0 0-4-4h-1M9 20H4v-1a4 4 0 0 1 4-4h1M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10z', 'route': 'app_user_roles_index'},
    {'label': 'Inventory', 'icon': 'M20 7l-8-4-8 4v10l8 4 8-4V7z', 'route': 'app_inventory'},
	{'label': 'Reports', 'icon': 'M4 4h16v16H4V4zm2 2v12h12V6H6zm3 2h6v2H9V8zm0 4h6v2H9v-2z', 'route': 'app_admin_reports'},
    {'label': 'Report', 'icon': 'M4 4h16v16H4V4zm2 2v12h12V6H6zm3 2h6v2H9V8zm0 4h6v2H9v-2z', 'route': 'app_customer_dashboard'},
	{'label': 'Catalog', 'icon': 'M21 21l-4.35-4.35M17 11a6 6 0 1 0-12 0 6 6 0 0 0 12 0z', 'route': 'app_catalog'},
	{'label': 'Activity Log', 'icon': 'M5 13l4 4L19 7', 'route': 'app_activity_logs'},
    {'label': 'Settings', 'icon': 'M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0-6v2m0 16v2m10-10h-2M4 12H2m15.364-7.364l-1.414 1.414M6.05 17.95l-1.414 1.414m0-15.364l1.414 1.414M17.95 17.95l1.414 1.414', 'route': 'app_setting'},
    ] %}

		{% set roles = app.user.getRoles() %}

		<nav class="flex-1 px-4 py-4 space-y-1">
			{% for item in allMenu %}
				{% set currentRoute = app.request.attributes.get('_route') %}

				{% if 'ROLE_ADMIN' in roles %}
					{% if item.label != 'Report' %}
						<a href="{{ path(item.route) }}" class="group flex items-center gap-4 py-2 px-2 rounded-lg transition {% if currentRoute starts with item.route %} bg-primary text-white border-l-4 border-gray-500 {% else %} hover:bg-gray-100 hover:text-primary text-gray-500 {% endif %}">
							<svg class="w-6 h-6 transition {% if currentRoute starts with item.route %} text-white {% else %} text-gray-320 group-hover:text-secondary {% endif %}" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
								<path d="{{ item.icon }}" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<span x-show="sidebarOpen" class="font-medium transition">{{ item.label }}</span>
						</a>
					{% endif %}
				{% elseif 'ROLE_STAFF' in roles %}
					{% if item.label in ['Inventory','Catalog','Reports','Settings'] %}
						<a href="{{ path(item.route) }}" class="group flex items-center gap-4 py-2 px-2 rounded-lg transition {% if currentRoute starts with item.route %} bg-primary text-white border-l-4 border-gray-500 {% else %} hover:bg-gray-100 hover:text-primary text-gray-500 {% endif %}">
							<svg class="w-6 h-6 transition {% if currentRoute starts with item.route %} text-white {% else %} text-gray-320 group-hover:text-secondary {% endif %}" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
								<path d="{{ item.icon }}" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<span x-show="sidebarOpen" class="font-medium transition">{{ item.label }}</span>
						</a>
					{% endif %}
				{% elseif 'ROLE_CUSTOMER' in roles %}
					{% if item.label in ['Report','Settings']  %}
						<a href="{{ path(item.route) }}" class="group flex items-center gap-4 py-2 px-2 rounded-lg transition {% if currentRoute starts with item.route %} bg-primary text-white border-l-4 border-gray-500 {% else %} hover:bg-gray-100 hover:text-primary text-gray-500 {% endif %}">
							<svg class="w-6 h-6 transition {% if currentRoute starts with item.route %} text-white {% else %} text-gray-320 group-hover:text-secondary {% endif %}" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
								<path d="{{ item.icon }}" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<span x-show="sidebarOpen" class="font-medium transition">{{ item.label }}</span>
						</a>
					{% endif %}
				{% endif %}
			{% endfor %}
		</nav>


		<!-- User panel -->
		<div class="p-4 mt-auto flex items-center justify-between bg-accent">
			<div class="flex items-center gap-3" x-show="sidebarOpen">
				<div class="h-10 w-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-semibold">
					{{ app.user.getFullName|first|upper }}
				</div>
				<div>
					<p class="text-sm font-bold">{{ app.user.getFullName() }}</p>
					<p class="text-xs font-bold text-gray-100 uppercase">Welcome to Sabre</p>
				</div>
			</div>
			<form method="post" action="{{ path('app_logout') }}">
				<button type="submit" class="w-10 h-10 flex items-center justify-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewbox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
					</svg>
				</button>
			</form>
		</div>
	</aside>
</div>
